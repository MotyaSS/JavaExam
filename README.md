# Экзамен РПКС
### Жбанков Матвей - 313Б
# Вопрос 1. Коллекции Java. Иерархия классов и интерфейсов для коллекций. Примеры.
```text
Iterable
        Collection
            List → (ArrayList, LinkedList, Vector)
            Set → (HashSet, LinkedHashSet, TreeSet)
                SortedSet
                    NavigableSet
            Queue → (PriorityQueue, ArrayDeque)
                Deque
    Map → (HashMap, LinkedHashMap, TreeMap)
        SortedMap
            NavigableMap
```

---
### Интерфейсы коллекций

#### Collection

- Базовый интерфейс для всех коллекций (кроме Map).
- Методы: `add`, `remove`, `size`, `iterator` и др.

#### List

- Упорядоченная коллекция элементов (допускает дубли).
- Примеры: `ArrayList`, `LinkedList`, `Vector`.

#### Set

- Коллекция уникальных элементов (без дубликатов).
- Примеры: `HashSet`, `LinkedHashSet`, `TreeSet`.

#### Queue

- Очереди, работающие по принципу FIFO (first-in, first-out).
- Примеры: `PriorityQueue`, `ArrayDeque`.

#### Deque

- Двунаправленная очередь (double ended queue).
- Пример: `ArrayDeque`.

#### Map

- Коллекция пар «ключ-значение».
- Не наследует `Collection`.
- Примеры: `HashMap`, `TreeMap`, `LinkedHashMap`.

___
___

# Вопрос 2. Паттерн SAGA. Что такое оркестратор. Реализация через REST. Реализация через событийную модель (Kafka). Плюсы и минусы каждого подхода. Главные минусы событийной реализации SAGA. Реализация распределенных транзакций.

**SAGA** — это паттерн управления распределёнными транзакциями в микросервисной архитектуре. Он позволяет выполнять серию локальных транзакций в разных сервисах, обеспечивая целостность данных без использования распределённых блокировок.

- После каждой локальной транзакции публикуется событие или выполняется REST-вызов для следующей транзакции.
- Если одна из транзакций не удалась, для уже выполненных транзакций вызываются компенсирующие действия (откаты).

---

**Оркестратор** (Saga Orchestrator) — это компонент, который управляет последовательностью выполнения шагов SAGA, решает, какой сервис и когда должен быть вызван, а также отвечает за запуск компенсирующих транзакций в случае ошибок.

- Оркестратор может быть реализован в виде отдельного сервиса или как часть одного из участников SAGA.

---

**REST-реализация** SAGA обычно строится по принципу оркестрации:

1. Оркестратор инициирует бизнес-процесс через REST API.
2. Оркестратор вызывает необходимые сервисы поочередно через HTTP-запросы.
3. При ошибке оркестратор вызывает компенсирующие методы через REST.

### Пример последовательности:
- Оркестратор → Service A (POST /action)
- Оркестратор → Service B (POST /action)
- Service B падает → Оркестратор → Service A (POST /compensate)

**Плюсы:**
- Простая отладка и мониторинг (все шаги видны в одном месте).
- Централизованный контроль над бизнес-логикой.
- Можно легко реализовать логику отката.

**Минусы:**
- Оркестратор — потенциальное узкое место (single point of failure).
- Сильная связанность между сервисами.
- Необходимость реализовать обработку сбоев и таймаутов.

---

**Событийная реализация** (хореография):

1. Каждый сервис подписан на определённые события (например, Kafka topic).
2. Выполнив свою локальную транзакцию, сервис публикует событие.
3. Следующий сервис, получив событие, выполняет свою работу и публикует следующее событие.
4. В случае ошибки сервис публикует событие для компенсирующих транзакций.

#### Пример последовательности:
- Service A завершил транзакцию → публикует Event A_DONE.
- Service B слушает Event A_DONE → выполняет свою транзакцию → Event B_DONE.
- Если ошибка — сервис публикует Event B_FAILED.

**Плюсы:**
- Нет центральной точки отказа.
- Слабое связывание между сервисами.
- Хорошо масштабируется.

**Минусы:**
- Сложная трассировка и отладка цепочки событий.
- Нет централизованного контроля за бизнес-логикой.
- Возможны гонки и дублирование сообщений.
- Сложно гарантировать последовательность выполнения и согласованность.
- Откаты могут быть реализованы не полностью или некорректно.

---

#### Главные минусы событийной реализации SAGA

- **Потеря прозрачности**: трудно понять, на каком шаге находится бизнес-процесс.
- **Нет централизованного контроля**: логика размазана по сервисам.
- **Сложность управления откатами**: возможны частичные или дублирующиеся откаты.
- **Возможны гонки, дублирование событий, неатомарность**: сервисы могут получать события с задержкой или несколько раз.
- **Высокие требования к идемпотентности операций**: операции должны быть устойчивы к повторным вызовам.

---

#### Реализация распределённых транзакций

Классические распределённые транзакции (например, 2PC — two-phase commit) редко применяются в микросервисах из-за высокой связанности и низкой отказоустойчивости.

**SAGA** — альтернатива распределённым транзакциям:

- Вместо глобальной блокировки используются локальные транзакции и компенсирующие действия.
- Можно реализовать через оркестрацию (REST) или хореографию (Kafka, события).

---

# *Фиита Ля Комедия*

### *комментарий к задачке*
- пример запроса - http://localhost:8080/task?bootstrapServers=localhost:9092&topic=your_topic
- kafka, postgres в докерфайле